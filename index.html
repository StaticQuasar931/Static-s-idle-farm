<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idle Farm Simulator</title>
    <style>
        /* Basic Styling */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: linear-gradient(to bottom, #a1c4fd, #c2e9fb);
            color: #000;
            margin: 0;
            padding: 0;
            transition: background 0.5s, color 0.5s;
        }
        h1 {
            margin-top: 20px;
            font-size: 3em;
        }
        .farm {
            margin: 20px;
            background-color: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .section {
            margin: 20px 0;
        }
        .crop, .animal, .upgrade, .quest, .achievement, .decoration, .passive-farm {
            margin: 15px;
            padding: 20px;
            border: 3px solid #4CAF50;
            border-radius: 15px;
            background-color: #fff;
            display: inline-block;
            width: 220px;
            position: relative;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .crop:hover, .animal:hover, .upgrade:hover, .quest:hover, .achievement:hover, .decoration:hover, .passive-farm:hover {
            background-color: #f0f0f0;
            transform: scale(1.05);
        }
        .emoji {
            font-size: 3em;
        }
        .button-outline {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 6px solid #4CAF50;
            border-radius: 10px;
            animation: buttonOutlineProgress linear;
            animation-timing-function: ease-in-out;
            animation-iteration-count: 1;
            pointer-events: none;
            transform-origin: left;
        }
        @keyframes buttonOutlineProgress {
            0% {
                transform: scaleX(0);
            }
            100% {
                transform: scaleX(1);
            }
        }
        /* Notification Container */
        #notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        /* Achievements Section */
        #achievements-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .achievement {
            border: 2px solid #FFD700;
            background-color: #FFFACD;
        }
        /* Quests Section */
        #quests-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        /* Upgrades Section */
        #upgrades-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        /* Decorations Section */
        #decorations-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        /* Passive Farms Section */
        #passive-farms-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 180px;
            background-color: #555;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%; /* Position above */
            left: 50%;
            margin-left: -90px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        /* Progress Bars */
        .progress-bar {
            width: 100%;
            background-color: #ddd;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress-bar-inner {
            height: 20px;
            width: 0%;
            background-color: #4CAF50;
            transition: width 1s linear;
        }
        /* Focus Mode */
        #focus-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #focus-mode-toggle:hover {
            background-color: #45a049;
        }
        /* Theme Toggle */
        #theme-toggle {
            position: fixed;
            bottom: 80px;
            right: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #theme-toggle:hover {
            background-color: #45a049;
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            .crop, .animal, .upgrade, .quest, .achievement, .decoration, .passive-farm {
                width: 80%;
                margin: 10px auto;
                display: block;
            }
        }
        /* Dark Mode Styles */
        body.dark-mode {
            background: linear-gradient(to bottom, #2c3e50, #4ca1af);
            color: #fff;
        }
        body.dark-mode .farm {
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
        }
        body.dark-mode .crop, 
        body.dark-mode .animal, 
        body.dark-mode .upgrade, 
        body.dark-mode .quest, 
        body.dark-mode .achievement, 
        body.dark-mode .decoration, 
        body.dark-mode .passive-farm {
            background-color: #34495e;
            border-color: #1abc9c;
            color: #ecf0f1;
        }
        body.dark-mode .tooltip .tooltiptext {
            background-color: #333;
        }
        body.dark-mode .progress-bar {
            background-color: #555;
        }
        body.dark-mode .progress-bar-inner {
            background-color: #1abc9c;
        }
        body.dark-mode #focus-mode-toggle, 
        body.dark-mode #theme-toggle {
            background-color: #1abc9c;
        }
        /* Auto-Save Notification */
        #auto-save-notification {
            position: fixed;
            bottom: 140px;
            right: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: #fff;
            border: none;
            border-radius: 10px;
            display: none;
            z-index: 1001;
            transition: opacity 0.5s;
        }
    </style>
</head>
<body>
    <h1>Idle Farm Simulator üåæ</h1>
    <p>Made by <a href="https://sites.google.com/view/staticquasar931" style="color: #ff8800">Static</a></p>
    <button onclick="window.location.href='https://sites.google.com/view/staticquasar931/static-gmes/statics-idle-farm-sim'" style="margin-top: 10px; padding: 10px 20px; font-size: 1em; cursor: pointer;">Play Game</button>
    
    <div class="farm">
        <!-- Currencies Display -->
        <div class="section">
            <p>Coins: <span id="coins">0</span> üí∞ | Gems: <span id="gems">0</span> üíé</p>
            <p id="auto-save-advertisement" style="font-size: 0.9em; color: #555;">Game progress is automatically saved! üõ°Ô∏è</p>
        </div>
        
        <!-- Crops Section -->
        <div class="section">
            <h2>Crops üå±</h2>
            <div id="crops-container">
                <div class="crop" id="wheat" onclick="grow('wheat', 10)">
                    <div class="emoji">üåæ</div>
                    <h3>Wheat</h3>
                    <p>Growth Time: <span id="wheatGrowth">5</span>s</p>
                    <div id="wheatButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="wheatProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="crop" id="corn" onclick="grow('corn', 15)">
                    <div class="emoji">üåΩ</div>
                    <h3>Corn</h3>
                    <p>Growth Time: <span id="cornGrowth">8</span>s</p>
                    <div id="cornButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="cornProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="crop" id="pumpkin" onclick="grow('pumpkin', 25)">
                    <div class="emoji">üéÉ</div>
                    <h3>Pumpkin</h3>
                    <p>Growth Time: <span id="pumpkinGrowth">12</span>s</p>
                    <div id="pumpkinButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="pumpkinProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <!-- Additional Crops -->
                <div class="crop" id="tomato" onclick="grow('tomato', 20)">
                    <div class="emoji">üçÖ</div>
                    <h3>Tomato</h3>
                    <p>Growth Time: <span id="tomatoGrowth">7</span>s</p>
                    <div id="tomatoButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="tomatoProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="crop" id="carrot" onclick="grow('carrot', 12)">
                    <div class="emoji">ü•ï</div>
                    <h3>Carrot</h3>
                    <p>Growth Time: <span id="carrotGrowth">6</span>s</p>
                    <div id="carrotButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="carrotProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Animals Section -->
        <div class="section">
            <h2>Animals üêÑ</h2>
            <div id="animals-container">
                <div class="animal" id="chicken" onclick="grow('chicken', 20)">
                    <div class="emoji">üêî</div>
                    <h3>Chicken</h3>
                    <p>Egg Time: <span id="chickenProduction">10</span>s</p>
                    <div id="chickenButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="chickenProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="animal" id="cow" onclick="grow('cow', 30)">
                    <div class="emoji">üêÑ</div>
                    <h3>Cow</h3>
                    <p>Milk Time: <span id="cowProduction">15</span>s</p>
                    <div id="cowButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="cowProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="animal" id="sheep" onclick="grow('sheep', 40)">
                    <div class="emoji">üêë</div>
                    <h3>Sheep</h3>
                    <p>Wool Time: <span id="sheepProduction">20</span>s</p>
                    <div id="sheepButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="sheepProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="animal" id="goat" onclick="grow('goat', 50)">
                    <div class="emoji">üêê</div>
                    <h3>Goat</h3>
                    <p>Milk Time: <span id="goatProduction">18</span>s</p>
                    <div id="goatButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="goatProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <!-- Additional Animals -->
                <div class="animal" id="duck" onclick="grow('duck', 25)">
                    <div class="emoji">ü¶Ü</div>
                    <h3>Duck</h3>
                    <p>Egg Time: <span id="duckProduction">12</span>s</p>
                    <div id="duckButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="duckProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
                <div class="animal" id="pig" onclick="grow('pig', 35)">
                    <div class="emoji">üêñ</div>
                    <h3>Pig</h3>
                    <p>Truffle Time: <span id="pigProduction">25</span>s</p>
                    <div id="pigButtonOutline" class="button-outline" style="display: none;"></div>
                    <div class="progress-bar">
                        <div id="pigProgress" class="progress-bar-inner"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Upgrades Section -->
        <div class="section">
            <h2>Upgrades üöú</h2>
            <div id="upgrades-container">
                <div class="upgrade tooltip" onclick="buyFertilizer()">
                    <h3>Buy Fertilizer</h3>
                    <p>(50 coins)</p>
                    <span class="tooltiptext">Reduces wheat and chicken growth times by 1s.</span>
                </div>
                <div class="upgrade tooltip" onclick="buyTractor()">
                    <h3>Buy Tractor</h3>
                    <p>(150 coins)</p>
                    <span class="tooltiptext">Reduces corn and cow production times by 2s.</span>
                </div>
                <div class="upgrade tooltip" onclick="buyBarn()">
                    <h3>Buy Barn</h3>
                    <p>(300 coins)</p>
                    <span class="tooltiptext">Allows you to keep more animals.</span>
                </div>
                <div class="upgrade tooltip" onclick="buyGreenhouse()">
                    <h3>Buy Greenhouse</h3>
                    <p>(500 coins)</p>
                    <span class="tooltiptext">Reduces pumpkin growth time by 3s.</span>
                </div>
                <div class="upgrade tooltip" onclick="buyIrrigation()">
                    <h3>Buy Irrigation</h3>
                    <p>(800 coins)</p>
                    <span class="tooltiptext">Reduces wheat and corn growth times by 2s.</span>
                </div>
                <div class="upgrade tooltip" onclick="buyWindmill()">
                    <h3>Buy Windmill</h3>
                    <p>(1000 coins)</p>
                    <span class="tooltiptext">Reduces sheep and goat production times by 5s.</span>
                </div>
                <div class="upgrade tooltip" onclick="buyMarket()">
                    <h3>Buy Market</h3>
                    <p>(2000 coins)</p>
                    <span class="tooltiptext">Increases coin rewards by 10%.</span>
                </div>
                <!-- Upgrade Tiers -->
                <div class="upgrade tooltip" onclick="buyAdvancedTractor()">
                    <h3>Advanced Tractor</h3>
                    <p>(5000 coins)</p>
                    <span class="tooltiptext">Further reduces corn and cow production times by 3s.</span>
                </div>
                <div class="upgrade tooltip" onclick="buySuperWindmill()">
                    <h3>Super Windmill</h3>
                    <p>(8000 coins)</p>
                    <span class="tooltiptext">Further reduces sheep and goat production times by 5s.</span>
                </div>
            </div>
        </div>
        
        <!-- Passive Farms Section -->
        <div class="section">
            <h2>Passive Farms üåæ</h2>
            <div id="passive-farms-container">
                <div class="passive-farm" id="passiveCrop1" onclick="buyPassiveCrop('passiveCrop1', 500)">
                    <h3>Passive Wheat Farm</h3>
                    <p>Cost: 500 coins</p>
                    <p>Generates 5 coins every 10s</p>
                </div>
                <div class="passive-farm" id="passiveAnimal1" onclick="buyPassiveAnimal('passiveAnimal1', 1000)">
                    <h3>Passive Chicken Coop</h3>
                    <p>Cost: 1000 coins</p>
                    <p>Generates 15 coins every 20s</p>
                </div>
            </div>
        </div>
        
        <!-- Decorations Section -->
        <div class="section">
            <h2>Decorations üé®</h2>
            <div id="decorations-container">
                <div class="decoration tooltip" onclick="buyDecoration('statue', 300)">
                    <h3>Statue</h3>
                    <p>(300 coins)</p>
                    <span class="tooltiptext">Beautify your farm. No gameplay effect.</span>
                </div>
                <div class="decoration tooltip" onclick="buyDecoration('fountain', 500)">
                    <h3>Fountain</h3>
                    <p>(500 coins)</p>
                    <span class="tooltiptext">Adds a fountain to your farm. No gameplay effect.</span>
                </div>
            </div>
        </div>
        
        <!-- Quests Section -->
        <div class="section">
            <h2>Quests üéØ</h2>
            <div id="quests-container">
                <!-- Quests will be dynamically added here -->
            </div>
        </div>
        
        <!-- Achievements Section -->
        <div class="section">
            <h2>Achievements üèÜ</h2>
            <div id="achievements-container">
                <!-- Achievements will be dynamically added here -->
            </div>
        </div>
        
        <!-- Prestige Section -->
        <div class="section">
            <h2>Prestige ‚ú®</h2>
            <button onclick="prestige()" style="padding: 10px 20px; font-size: 1em; cursor: pointer;">Reset for Prestige (1000 Coins)</button>
            <p>Prestige Count: <span id="prestigeCount">0</span></p>
            <p>Coin Multiplier: x<span id="coinMultiplier">1</span></p>
        </div>
    </div>
    
    <!-- Notification Container -->
    <div id="notification-container"></div>
    
    <!-- Auto-Save Notification -->
    <div id="auto-save-notification">Game has been auto-saved! ‚úÖ</div>
    
    <!-- Audio Elements -->
    <audio id="coinSound" src="https://www.soundjay.com/button/sounds/button-16.mp3" preload="auto"></audio>
    <audio id="achievementSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3" preload="auto"></audio>
    <audio id="upgradeSound" src="https://www.soundjay.com/button/sounds/button-4.mp3" preload="auto"></audio>
    <audio id="prestigeSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-03.mp3" preload="auto"></audio>
    <audio id="decorationSound" src="https://www.soundjay.com/button/sounds/button-10.mp3" preload="auto"></audio>
    <audio id="passiveSound" src="https://www.soundjay.com/button/sounds/button-09.mp3" preload="auto"></audio>
    <audio id="dailyBonusSound" src="https://www.soundjay.com/misc/sounds/bell-ringing-07.mp3" preload="auto"></audio>
    
    <!-- Focus Mode and Theme Toggle Buttons -->
    <button id="focus-mode-toggle" onclick="toggleFocusMode()">üîí Focus Mode</button>
    <button id="theme-toggle" onclick="toggleTheme()">üåó Toggle Theme</button>
    
    <script>
        // Game Variables
        let coins = 0;
        let gems = 0;
        let growthTimers = {};
        let passiveTimers = {};
        let growthTimes = {
            wheat: 5,
            corn: 8,
            pumpkin: 12,
            tomato: 7,
            carrot: 6,
            chicken: 10,
            cow: 15,
            sheep: 20,
            goat: 18,
            duck: 12,
            pig: 25
        };
        let baseRewards = {
            wheat: 10,
            corn: 15,
            pumpkin: 25,
            tomato: 20,
            carrot: 12,
            chicken: 20,
            cow: 30,
            sheep: 40,
            goat: 50,
            duck: 25,
            pig: 35
        };
        let activeNotifications = 0;
        const maxNotifications = 3;
        let achievements = {};
        let quests = [];
        let completedQuests = [];
        let prestigeCount = 0;
        let coinMultiplier = 1;
        let focusMode = false;
        let theme = 'light';
        let dailyBonusClaimed = false;
        
        // Sound Effects
        const coinSound = document.getElementById('coinSound');
        const achievementSound = document.getElementById('achievementSound');
        const upgradeSound = document.getElementById('upgradeSound');
        const prestigeSound = document.getElementById('prestigeSound');
        const decorationSound = document.getElementById('decorationSound');
        const passiveSound = document.getElementById('passiveSound');
        const dailyBonusSound = document.getElementById('dailyBonusSound');
        
        // Initialization
        window.onload = function() {
            loadGame();
            generateQuests();
            generateAchievements();
            updateCoins();
            updateGems();
            updatePrestige();
            renderQuests();
            renderAchievements();
            checkDailyBonus();
            startPassiveIncome();
            updateTheme();
            showAutoSaveNotification();
        };
        
        window.onbeforeunload = saveGame;
        
        // Grow Function
        function grow(item, reward) {
            if (!growthTimers[item]) {
                let outline = document.getElementById(`${item}ButtonOutline`);
                outline.style.display = 'block';
                outline.style.animationDuration = `${growthTimes[item]}s`;
                
                // Start Progress Bar
                let progressBar = document.getElementById(`${item}Progress`);
                progressBar.style.width = '0%';
                setTimeout(() => {
                    progressBar.style.width = '100%';
                }, 100);
                
                growthTimers[item] = setTimeout(() => {
                    coins += reward * coinMultiplier;
                    coinSound.play();
                    updateCoins();
                    alertInGame(`${capitalize(item)} collected! +${reward * coinMultiplier} coins`);
                    growthTimers[item] = null;
                    outline.style.display = 'none';
                    progressBar.style.width = '0%';
                    checkAchievements(item);
                    checkQuests(item);
                }, growthTimes[item] * 1000);
            }
        }
        
        // Passive Income Functions
        function buyPassiveCrop(id, cost) {
            if (coins >= cost && !document.getElementById(id).classList.contains('owned')) {
                coins -= cost;
                document.getElementById(id).classList.add('owned');
                passiveSound.play();
                alertInGame('Passive Wheat Farm purchased! üí∞ Generates 5 coins every 10s.');
                startPassiveIncomeItem(id, 10, 5);
                updateCoins();
                checkAchievements(null); // For passive farm achievements
            } else {
                alertInGame('Not enough coins or already owned!');
            }
        }
        
        function buyPassiveAnimal(id, cost) {
            if (coins >= cost && !document.getElementById(id).classList.contains('owned')) {
                coins -= cost;
                document.getElementById(id).classList.add('owned');
                passiveSound.play();
                alertInGame('Passive Chicken Coop purchased! üí∞ Generates 15 coins every 20s.');
                startPassiveIncomeItem(id, 20, 15);
                updateCoins();
                checkAchievements(null); // For passive farm achievements
            } else {
                alertInGame('Not enough coins or already owned!');
            }
        }
        
        function startPassiveIncomeItem(id, interval, amount) {
            passiveTimers[id] = setInterval(() => {
                coins += amount * coinMultiplier;
                coinSound.play();
                updateCoins();
                alertInGame(`Passive income: +${amount * coinMultiplier} coins from ${capitalize(id.replace('passive', '').toLowerCase())}`);
            }, interval * 1000);
        }
        
        function startPassiveIncome() {
            // Initialize existing passive farms
            ['passiveCrop1', 'passiveAnimal1'].forEach(id => {
                if (document.getElementById(id).classList.contains('owned')) {
                    if (id === 'passiveCrop1') {
                        startPassiveIncomeItem(id, 10, 5);
                    }
                    if (id === 'passiveAnimal1') {
                        startPassiveIncomeItem(id, 20, 15);
                    }
                }
            });
        }
        
        // Buy Upgrades
        function buyFertilizer() {
            if (coins >= 50) {
                coins -= 50;
                growthTimes.wheat = Math.max(1, growthTimes.wheat - 1);
                growthTimes.chicken = Math.max(5, growthTimes.chicken - 1);
                upgradeSound.play();
                alertInGame('Fertilizer purchased! üå± Wheat and Chicken growth times decreased by 1s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyTractor() {
            if (coins >= 150) {
                coins -= 150;
                growthTimes.corn = Math.max(4, growthTimes.corn - 2);
                growthTimes.cow = Math.max(10, growthTimes.cow - 2);
                upgradeSound.play();
                alertInGame('Tractor purchased! üöú Corn and Cow production times decreased by 2s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyBarn() {
            if (coins >= 300) {
                coins -= 300;
                // Implement barn functionality (e.g., increase animal capacity)
                upgradeSound.play();
                alertInGame('Barn purchased! üè† You can now keep more animals!');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyGreenhouse() {
            if (coins >= 500) {
                coins -= 500;
                growthTimes.pumpkin = Math.max(6, growthTimes.pumpkin - 3);
                upgradeSound.play();
                alertInGame('Greenhouse purchased! üåø Pumpkin growth time decreased by 3s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyIrrigation() {
            if (coins >= 800) {
                coins -= 800;
                growthTimes.wheat = Math.max(1, growthTimes.wheat - 2);
                growthTimes.corn = Math.max(2, growthTimes.corn - 2);
                upgradeSound.play();
                alertInGame('Irrigation System purchased! üí¶ Wheat and Corn growth times decreased by 2s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyWindmill() {
            if (coins >= 1000) {
                coins -= 1000;
                growthTimes.sheep = Math.max(10, growthTimes.sheep - 5);
                growthTimes.goat = Math.max(10, growthTimes.goat - 5);
                upgradeSound.play();
                alertInGame('Windmill purchased! üå¨Ô∏è Sheep and Goat production times decreased by 5s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyMarket() {
            if (coins >= 2000) {
                coins -= 2000;
                coinMultiplier += 0.1; // Increase coin rewards by 10%
                upgradeSound.play();
                alertInGame('Market purchased! üíº Coin rewards increased by 10%.');
                updateCoins();
                checkAchievements('market'); // For market-related achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buyAdvancedTractor() {
            if (coins >= 5000) {
                coins -= 5000;
                growthTimes.corn = Math.max(2, growthTimes.corn - 3);
                growthTimes.cow = Math.max(7, growthTimes.cow - 3);
                upgradeSound.play();
                alertInGame('Advanced Tractor purchased! üöú Corn and Cow production times decreased by 3s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        function buySuperWindmill() {
            if (coins >= 8000) {
                coins -= 8000;
                growthTimes.sheep = Math.max(5, growthTimes.sheep - 5);
                growthTimes.goat = Math.max(5, growthTimes.goat - 5);
                upgradeSound.play();
                alertInGame('Super Windmill purchased! üå¨Ô∏è Sheep and Goat production times decreased by 5s.');
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        // Buy Decorations
        function buyDecoration(decoration, cost) {
            if (coins >= cost) {
                coins -= cost;
                decorationSound.play();
                alertInGame(`${capitalize(decoration)} decoration added to your farm! üéâ`);
                updateCoins();
                checkAchievements(null); // For any relevant achievements
            } else {
                alertInGame('Not enough coins!');
            }
        }
        
        // Update Coins Display
        function updateCoins() {
            document.getElementById('coins').innerText = coins;
        }
        
        // Update Gems Display
        function updateGems() {
            document.getElementById('gems').innerText = gems;
        }
        
        // Update Prestige Display
        function updatePrestige() {
            document.getElementById('prestigeCount').innerText = prestigeCount;
            document.getElementById('coinMultiplier').innerText = coinMultiplier.toFixed(1);
        }
        
        // In-Game Notifications
        function alertInGame(message) {
            if (activeNotifications >= maxNotifications) return;
            activeNotifications++;
            let notification = document.createElement('div');
            notification.innerText = message;
            notification.style.padding = '10px 20px';
            notification.style.marginTop = '10px';
            notification.style.backgroundColor = '#ffcc00';
            notification.style.border = '2px solid #333';
            notification.style.borderRadius = '5px';
            notification.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
            notification.style.opacity = '0';
            notification.style.transition = 'opacity 0.5s';
            document.getElementById('notification-container').appendChild(notification);
            setTimeout(() => {
                notification.style.opacity = '1';
            }, 100);
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    notification.remove();
                    activeNotifications--;
                }, 500);
            }, 3000);
        }
        
        // Save Game State
        function saveGame() {
            const gameState = {
                coins,
                gems,
                growthTimes,
                prestigeCount,
                coinMultiplier,
                achievements,
                completedQuests,
                passiveFarms: getOwnedPassiveFarms(),
                theme,
                dailyBonusClaimed
            };
            localStorage.setItem('idleFarmGameState', JSON.stringify(gameState));
        }
        
        // Load Game State
        function loadGame() {
            const savedState = JSON.parse(localStorage.getItem('idleFarmGameState'));
            if (savedState) {
                coins = savedState.coins || 0;
                gems = savedState.gems || 0;
                growthTimes = savedState.growthTimes || growthTimes;
                prestigeCount = savedState.prestigeCount || 0;
                coinMultiplier = savedState.coinMultiplier || 1;
                achievements = savedState.achievements || {};
                completedQuests = savedState.completedQuests || [];
                theme = savedState.theme || 'light';
                dailyBonusClaimed = savedState.dailyBonusClaimed || false;
                
                // Restore passive farms
                if (savedState.passiveFarms) {
                    savedState.passiveFarms.forEach(id => {
                        document.getElementById(id).classList.add('owned');
                    });
                }
                
                updateCoins();
                updateGems();
                updatePrestige();
            }
        }
        
        // Prestige System
        function prestige() {
            if (coins >= 1000) {
                coins -= 1000;
                prestigeCount += 1;
                coinMultiplier += 0.5; // Increase multiplier
                updateCoins();
                updatePrestige();
                prestigeSound.play();
                alertInGame('Prestige achieved! ‚ú® Coin rewards increased by 50%.');
                checkAchievements(null); // For prestige-related achievements
                resetGame(false);
            } else {
                alertInGame('Not enough coins to prestige!');
            }
        }
        
        // Reset Game Function
        function resetGame(completeReset = true) {
            // Clear growth timers
            for (let key in growthTimers) {
                clearTimeout(growthTimers[key]);
            }
            growthTimers = {};
            
            // Clear passive timers
            for (let key in passiveTimers) {
                clearInterval(passiveTimers[key]);
            }
            passiveTimers = {};
            
            // Reset variables
            coins = 0;
            gems = 0;
            growthTimes = {
                wheat: 5,
                corn: 8,
                pumpkin: 12,
                tomato: 7,
                carrot: 6,
                chicken: 10,
                cow: 15,
                sheep: 20,
                goat: 18,
                duck: 12,
                pig: 25
            };
            if (completeReset) {
                achievements = {};
                completedQuests = [];
                coinMultiplier = 1;
                document.querySelectorAll('.owned').forEach(el => el.classList.remove('owned'));
            }
            updateCoins();
            updateGems();
            updatePrestige();
            renderQuests();
            renderAchievements();
            generateQuests();
            generateAchievements();
            startPassiveIncome();
        }
        
        // Achievements System
        function generateAchievements() {
            const achievementList = [
                { id: 'ach1', description: 'Harvest 10 Wheat', goal: 10, type: 'crop', item: 'wheat' },
                { id: 'ach2', description: 'Harvest 50 Corn', goal: 50, type: 'crop', item: 'corn' },
                { id: 'ach3', description: 'Collect 1000 Coins', goal: 1000, type: 'coins', item: null },
                { id: 'ach4', description: 'Raise 20 Chickens', goal: 20, type: 'animal', item: 'chicken' },
                { id: 'ach5', description: 'Unlock Market Upgrade', goal: 'market', type: 'upgrade', item: 'market' },
                { id: 'ach6', description: 'Prestige 1 Time', goal: 1, type: 'prestige', item: null },
                { id: 'ach7', description: 'Own 1 Passive Farm', goal: 1, type: 'passive', item: null }
            ];
            achievementList.forEach(ach => {
                if (!achievements[ach.id]) {
                    achievements[ach.id] = { ...ach, achieved: false, count: 0 };
                }
            });
        }
        
        function checkAchievements(item) {
            for (let key in achievements) {
                let ach = achievements[key];
                if (!ach.achieved) {
                    if (ach.type === 'crop' && ach.item === item) {
                        ach.count += 1;
                        if (ach.count >= ach.goal) {
                            ach.achieved = true;
                            gems += 10;
                            achievementSound.play();
                            alertInGame(`Achievement Unlocked: ${ach.description} +10 Gems!`);
                        }
                    }
                    if (ach.type === 'animal' && ach.item === item) {
                        ach.count += 1;
                        if (ach.count >= ach.goal) {
                            ach.achieved = true;
                            gems += 20;
                            achievementSound.play();
                            alertInGame(`Achievement Unlocked: ${ach.description} +20 Gems!`);
                        }
                    }
                    if (ach.type === 'coins' && ach.item === null) {
                        if (coins >= ach.goal) {
                            ach.achieved = true;
                            gems += 50;
                            achievementSound.play();
                            alertInGame(`Achievement Unlocked: ${ach.description} +50 Gems!`);
                        }
                    }
                    if (ach.type === 'upgrade' && ach.item === item) {
                        if (item === 'market' && coinMultiplier > 1) { // Assuming market increases multiplier
                            ach.achieved = true;
                            gems += 100;
                            achievementSound.play();
                            alertInGame(`Achievement Unlocked: ${ach.description} +100 Gems!`);
                        }
                    }
                    if (ach.type === 'prestige' && item === null) {
                        if (prestigeCount >= ach.goal) {
                            ach.achieved = true;
                            gems += 150;
                            achievementSound.play();
                            alertInGame(`Achievement Unlocked: ${ach.description} +150 Gems!`);
                        }
                    }
                    if (ach.type === 'passive' && item === null) {
                        if (getOwnedPassiveFarms().length >= ach.goal) {
                            ach.achieved = true;
                            gems += 200;
                            achievementSound.play();
                            alertInGame(`Achievement Unlocked: ${ach.description} +200 Gems!`);
                        }
                    }
                }
            }
            renderAchievements();
            updateGems();
        }
        
        function renderAchievements() {
            const container = document.getElementById('achievements-container');
            container.innerHTML = '';
            for (let key in achievements) {
                let ach = achievements[key];
                let achDiv = document.createElement('div');
                achDiv.classList.add('achievement');
                achDiv.innerHTML = `<h4>${ach.achieved ? '‚úÖ' : 'üîÑ'} ${ach.description}</h4>`;
                container.appendChild(achDiv);
            }
        }
        
        // Quests System
        function generateQuests() {
            const questList = [
                { id: 'quest1', description: 'Harvest 20 Wheat', goal: 20, type: 'crop', item: 'wheat', reward: 100 },
                { id: 'quest2', description: 'Collect 500 Coins', goal: 500, type: 'coins', item: null, reward: 50 },
                { id: 'quest3', description: 'Buy 2 Upgrades', goal: 2, type: 'upgrade', item: null, reward: 150 },
                { id: 'quest4', description: 'Raise 10 Chickens', goal: 10, type: 'animal', item: 'chicken', reward: 200 },
                { id: 'quest5', description: 'Own 1 Passive Farm', goal: 1, type: 'passive', item: null, reward: 300 }
            ];
            quests = questList.filter(q => !completedQuests.includes(q.id));
        }
        
        function checkQuests(item) {
            quests.forEach(quest => {
                if (!completedQuests.includes(quest.id)) {
                    if (quest.type === 'crop' && quest.item === item) {
                        quest.count = (quest.count || 0) + 1;
                        if (quest.count >= quest.goal) {
                            completeQuest(quest);
                        }
                    }
                    if (quest.type === 'animal' && quest.item === item) {
                        quest.count = (quest.count || 0) + 1;
                        if (quest.count >= quest.goal) {
                            completeQuest(quest);
                        }
                    }
                    if (quest.type === 'coins' && quest.item === null) {
                        if (coins >= quest.goal) {
                            completeQuest(quest);
                        }
                    }
                    if (quest.type === 'upgrade' && quest.item === null) {
                        // Assuming any upgrade counts
                        // Implement upgrade counting if necessary
                        // For simplicity, count as completed once any upgrade is bought
                        // Here we count any upgrade purchase
                        quest.count = (quest.count || 0) + 1;
                        if (quest.count >= quest.goal) {
                            completeQuest(quest);
                        }
                    }
                    if (quest.type === 'passive' && quest.item === null) {
                        if (getOwnedPassiveFarms().length >= quest.goal) {
                            completeQuest(quest);
                        }
                    }
                }
            });
        }
        
        function completeQuest(quest) {
            coins += quest.reward;
            alertInGame(`Quest Completed: ${quest.description} +${quest.reward} coins!`);
            completedQuests.push(quest.id);
            quests = quests.filter(q => q.id !== quest.id);
            generateQuests();
            renderQuests();
            updateCoins();
            checkAchievements(quest.item);
        }
        
        function renderQuests() {
            const container = document.getElementById('quests-container');
            container.innerHTML = '';
            quests.forEach(quest => {
                if (!completedQuests.includes(quest.id)) {
                    let questDiv = document.createElement('div');
                    questDiv.classList.add('quest');
                    questDiv.innerHTML = `<h4>${quest.description}</h4><p>Reward: ${quest.reward} coins</p>`;
                    container.appendChild(questDiv);
                }
            });
        }
        
        // Prestige Functionality
        function prestige() {
            if (coins >= 1000) {
                coins -= 1000;
                prestigeCount += 1;
                coinMultiplier += 0.5; // Increase multiplier
                updateCoins();
                updatePrestige();
                prestigeSound.play();
                alertInGame('Prestige achieved! ‚ú® Coin rewards increased by 50%.');
                checkAchievements(null); // For prestige-related achievements
                resetGame(true); // Complete reset
            } else {
                alertInGame('Not enough coins to prestige!');
            }
        }
        
        // Passive Farms Helper
        function getOwnedPassiveFarms() {
            let owned = [];
            document.querySelectorAll('.passive-farm.owned').forEach(el => owned.push(el.id));
            return owned;
        }
        
        // Toggle Focus Mode
        function toggleFocusMode() {
            focusMode = !focusMode;
            const farmSections = document.querySelectorAll('.section');
            farmSections.forEach(section => {
                if (!['Crops üå±', 'Animals üêÑ', 'Upgrades üöú', 'Passive Farms üåæ', 'Decorations üé®', 'Quests üéØ', 'Achievements üèÜ', 'Prestige ‚ú®'].includes(section.querySelector('h2')?.innerText)) {
                    section.style.display = focusMode ? 'none' : 'block';
                }
            });
            document.getElementById('focus-mode-toggle').innerText = focusMode ? 'üîì Focus Mode' : 'üîí Focus Mode';
        }
        
        // Toggle Theme
        function toggleTheme() {
            theme = (theme === 'light') ? 'dark' : 'light';
            updateTheme();
        }
        
        function updateTheme() {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
            } else {
                document.body.classList.remove('dark-mode');
            }
            // Save theme preference
            saveGame();
        }
        
        // Daily Bonus System
        function checkDailyBonus() {
            const lastLogin = localStorage.getItem('lastLogin');
            const today = new Date().toDateString();
            if (lastLogin !== today && !dailyBonusClaimed) {
                showDailyBonus();
                localStorage.setItem('lastLogin', today);
            }
        }
        
        function showDailyBonus() {
            gems += 5;
            dailyBonusSound.play();
            alertInGame('Daily Bonus! +5 Gems! üåü');
            dailyBonusClaimed = true;
            updateGems();
        }
        
        // Reset Daily Bonus
        function resetDailyBonus() {
            dailyBonusClaimed = false;
        }
        
        // Automatically reset daily bonus at midnight
        setInterval(() => {
            const now = new Date();
            if (now.getHours() === 0 && now.getMinutes() === 0) {
                resetDailyBonus();
            }
        }, 60000); // Check every minute
        
        // Strategy Tips
        function showStrategyTip() {
            const tips = [
                "Focus on upgrading wheat and chicken early to maximize your income.",
                "Invest in passive farms to earn coins even when you're not actively playing.",
                "Complete daily quests for additional rewards and progression.",
                "Prestiging can significantly boost your coin earnings over time.",
                "Balance your investments between crops and animals for steady income."
            ];
            const randomTip = tips[Math.floor(Math.random() * tips.length)];
            alertInGame(`Strategy Tip: ${randomTip}`);
        }
        
        // Periodically show strategy tips
        setInterval(showStrategyTip, 300000); // Every 5 minutes
        
        // Capitalize Function
        function capitalize(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }
        
        // Accessibility: Keyboard Navigation
        document.addEventListener('keydown', function(event) {
            switch(event.key.toLowerCase()) {
                case 'c':
                    document.querySelector('.section:nth-of-type(2)').scrollIntoView();
                    break;
                case 'a':
                    document.querySelector('.section:nth-of-type(3)').scrollIntoView();
                    break;
                case 'u':
                    document.querySelector('.section:nth-of-type(4)').scrollIntoView();
                    break;
                case 'p':
                    document.querySelector('.section:nth-of-type(6)').scrollIntoView();
                    break;
                case 'd':
                    document.querySelector('.section:nth-of-type(5)').scrollIntoView();
                    break;
                case 'q':
                    document.querySelector('.section:nth-of-type(7)').scrollIntoView();
                    break;
                default:
                    break;
            }
        });
        
        // Auto-Save Functionality and Notification
        function showAutoSaveNotification() {
            setInterval(() => {
                saveGame();
                const notification = document.getElementById('auto-save-notification');
                notification.style.display = 'block';
                notification.style.opacity = '1';
                setTimeout(() => {
                    notification.style.opacity = '0';
                    setTimeout(() => {
                        notification.style.display = 'none';
                    }, 500);
                }, 2000);
            }, 60000); // Auto-save every 60 seconds
        }
        
        // Hidden Credits (Obfuscated)
        // C-r-e-a-t-e-d b-y: s-t-a-t-i-c
        // W-e-b-s-i-t-e: s-i-t-e-s.-g-o-o-g-l-e.-c-o-m/-v-i-e-w/s-t-a-t-i-c-q-u-a-s-a-r931
        // s-t-a-t-i-c-g-a-m-e
    </script>
</body>
</html>
